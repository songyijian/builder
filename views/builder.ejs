<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=750,target-densitydpi=device-dpi,user-scalable=no">
    <title>f2e 前端构建工具</title>
	<link rel="stylesheet" href="./css.css">
</head>
<body>
<form class="panel">
	<div>
		<h4>项目仓库：</h4>
		<% for(var i=0; i<ItemType.length; i++){%>
			<p class="btn_boxs">
				<em><%= ItemType[i].name %>：</em>
				<% for(var j=0; j<ItemType[i].list.length; j++){%>
					<input type="button" name="<%= ItemType[i].list[j].path %>" id="" value="<%= ItemType[i].list[j].name %>" />
				<% }%>
			</p><br/>
		<% }%>
	</div>
    <div>
        <h4>创建位置：</h4>
		<i>注意：Windows ? "\" : "/" </i>
        <input type="text" name="" id="path" value="" />
    </div>
    <div>
        <h4>模版：</h4>
        <p class="btn_box">
			<%for(var i=0; i<template.length; i++){%>
				<input type="button" name="<%= template[i].mb_id %>" id="" value="<%= template[i].name %>" />
			<%}%>
        </p>
    </div>
	<input type="button" name="" id="builder" value="创建项目" /> <span  id="gourl"></span> 
</form>

<div class="panel rk">
	<h4>项目仓库入口：</h4>
	<% for(var i=0; i<ItemType.length; i++){%>
		<div>
		<em><%= ItemType[i].name %>：</em>
			<% for(var j=0; j<ItemType[i].list.length; j++){%>
			<a class="" href="http://localhost:8000/<%= ItemType[i].name %>/<%= ItemType[i].list[j].name %>"><%= ItemType[i].list[j].name %>: <%= ItemType[i].list[j].path %></a>
			<% }%>
		</div>
	<% }%>
</div>

<script>
!function(){
	!function(){function Ajax(o){this.data={"url":"","type":"POST","dataType":"json","data":"","encode":false,"async":true,"success":function(e){},"err":function(e){},"initFn":function(_this){}};for(var i in o){this.data[i]=o[i]}if(this.data.url===""){return}this.fn={"jsonof":function(obj){var isjson=typeof(obj)=="object"&&Object.prototype.toString.call(obj).toLowerCase()=="[object object]"&&!obj.length;return isjson},"setUrlK":function setUrlK(ojson,encode){var s="",name,key;for(var p in ojson){if(ojson.hasOwnProperty(p)){name=p}key=ojson[p];var value=null;if(encode){s+="&"+name+"="+encodeURI(encodeURI((typeof key=="object"?JSON.stringify(key):key)))}else{s+="&"+name+"="+encodeURI((typeof key=="object"?JSON.stringify(key):key))}}return s.substring(1,s.length)}};this.go_data="";if(this.data.data&&(this.fn.jsonof(this.data.data)||typeof this.data.data==="string")){if(this.fn.jsonof(this.data.data)){this.go_data=this.fn.setUrlK(this.data.data,this.data.encode)}else{this.go_data=this.data.data}}else{return}this.init()}Ajax.prototype.init=function(){this.data.initFn(this);var _this=this;this.oAjax=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");if(this.data.type.toUpperCase()==="GET"){if(this.go_data){this.oAjax.open(this.data.type,this.data.url+"?"+this.go_data,this.data.async)}else{this.oAjax.open(this.data.type,this.data.url,this.data.async)}}if(this.data.type.toUpperCase()==="POST"){this.oAjax.open(this.data.type,this.data.url,this.data.async);this.oAjax.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")}this.oAjax.send(this.data.type.toUpperCase()==="GET"?null:this.go_data);this.oAjax.onreadystatechange=function(){_this.changefn()}};Ajax.prototype.changefn=function(){if(this.oAjax.readyState===4){this.statusCode=this.oAjax.status;if(this.statusCode===200){this.data.success(JSON.parse(this.oAjax.responseText))}else{this.data.err(this.statusCode)}}};window.Ajax=Ajax}();if(typeof(module)!=="undefined"){module.exports=window.Ajax}else{if(typeof define==="function"&&define.amd){define([],function(){return window.Ajax})}};
	function $(s){return document.querySelector(s)}
	function _$(s){return document.querySelectorAll(s)}
	let mbbtnBox = _$(".btn_box");
	let pathbtnBoxs = _$(".btn_boxs");
	let path = $("#path");

	mbbtnBox.forEach((items,index)=>{
		items.addEventListener('click', (ev)=>{
			let _this = ev.target;
			if(_this.nodeName === "INPUT"){
				if($("#mb_yes"))$("#mb_yes").id = "";
				_this.id = "mb_yes";
			}
		})
	})

	pathbtnBoxs.forEach((items,index)=>{
		items.addEventListener('click', (ev)=>{
			let _this = ev.target;
			if(_this.nodeName === "INPUT"){
				if($("#type_yes"))$("#type_yes").id = "";
				_this.id = "type_yes";
			}
		})
	})
	

	$("#builder").onclick = ()=>{
		let jData={}
		if(!$("#type_yes")){
			alert("滚粗！再瞅瞅项目类型");
			return;
		}
		jData.type= $("#type_yes").name;
		if(!path.value){
			alert("滚粗！你这是要创建空气吗？输入项目名称");
			return;
		}
		jData.path = path.value;
		if(!$("#mb_yes")){
			alert("滚粗！关于模版...");
			return;
		}
		jData.mold = $("#mb_yes").name;
		new Ajax({
			"url":"./get",
			"data":jData,
			initFn:(_this)=>{
				//console.log(_this.go_data)
			},
			"success":function(e){
				console.log(e)
				if(e.state>0){
					$("#gourl").innerHTML =`yes: <a href="${e.info}">${e.info} </a>`
				}else{ 
					$("#gourl").innerHTML =`no: ${e.info}` 
				}
			}
		})
	}
}()
</script>
</body>
</html>